
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Developer guidelines &#8212; Maliput Documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Installation and Quickstart" href="installation_quickstart.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="contributing.html" title="Contributing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation_quickstart.html" title="Installation and Quickstart"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Maliput Documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="developer-guidelines">
<h1><a class="toc-backref" href="#id6">Developer guidelines</a><a class="headerlink" href="#developer-guidelines" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#developer-guidelines" id="id6">Developer guidelines</a><ul>
<li><a class="reference internal" href="#workspace" id="id7">Workspace</a><ul>
<li><a class="reference internal" href="#package-description" id="id8">Package description</a></li>
<li><a class="reference internal" href="#continuous-integration" id="id9">Continuous integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coding-standards" id="id10">Coding standards</a><ul>
<li><a class="reference internal" href="#languages" id="id11">Languages</a><ul>
<li><a class="reference internal" href="#c-programming" id="id12">C++ programming</a></li>
<li><a class="reference internal" href="#python-programming" id="id13">Python programming</a></li>
<li><a class="reference internal" href="#cmake-programming" id="id14">CMake programming</a><ul>
<li><a class="reference internal" href="#libraries" id="id15">Libraries</a></li>
<li><a class="reference internal" href="#executables" id="id16">Executables</a></li>
<li><a class="reference internal" href="#resources" id="id17">Resources</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#testing" id="id18">Testing</a></li>
<li><a class="reference internal" href="#linting" id="id19">Linting</a></li>
<li><a class="reference internal" href="#supported-oss-and-environments" id="id20">Supported OSs and environments</a></li>
<li><a class="reference internal" href="#compiler-support" id="id21">Compiler support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#versioning" id="id22">Versioning</a><ul>
<li><a class="reference internal" href="#branches-and-tags-for-releases" id="id23">Branches and tags for releases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#releases" id="id24">Releases</a><ul>
<li><a class="reference internal" href="#named-major-releases" id="id25">Named major releases</a></li>
<li><a class="reference internal" href="#major-release-output" id="id26">Major release output</a></li>
<li><a class="reference internal" href="#how-to-release" id="id27">How to release?</a><ul>
<li><a class="reference internal" href="#make-a-new-major-maliput-workspace-release" id="id28">Make a new major <code class="docutils literal notranslate"><span class="pre">maliput</span></code> workspace release</a></li>
<li><a class="reference internal" href="#create-a-new-package-major-release" id="id29">Create a new package major release</a></li>
<li><a class="reference internal" href="#create-a-new-package-minor-release" id="id30">Create a new package minor release</a></li>
<li><a class="reference internal" href="#create-a-new-package-patch-release" id="id31">Create a new package patch release</a></li>
<li><a class="reference internal" href="#create-a-named-release-tarball" id="id32">Create a named release tarball</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="workspace">
<h2><a class="toc-backref" href="#id7">Workspace</a><a class="headerlink" href="#workspace" title="Permalink to this headline">¶</a></h2>
<div class="section" id="package-description">
<h3><a class="toc-backref" href="#id8">Package description</a><a class="headerlink" href="#package-description" title="Permalink to this headline">¶</a></h3>
<p>The following packages are provided:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Core packages:</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput">maliput</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_py">maliput_py</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/ament_cmake_doxygen">ament_cmake_doxygen</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_documentation">maliput_documentation</a></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Backend implementations:</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_dragway">maliput_dragway</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_malidrive">maliput_malidrive</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_multilane">maliput_multilane</a></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Integration packages:</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_integration">maliput_integration</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_integration_tests">maliput_integration_tests</a></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Mathematical support:</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/maliput_drake">maliput_drake</a></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Utility packages:</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/drake_vendor">drake_vendor</a></li>
<li><a class="reference external" href="https://github.com/RobotLocomotion/pybind11">pybind11</a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/dsim_docs_bundler">dsim_docs_bundler</a></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Delphyne:</dt>
<dd><ul class="first last">
<li><a href="#id33"><span class="problematic" id="id34">`delphyne`_</span></a></li>
<li><a class="reference external" href="https://github.com/ToyotaResearchInstitute/delphyne_gui">delphyne_gui</a></li>
<li><a href="#id35"><span class="problematic" id="id36">`delphyne_demos`_</span></a></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Each repository may contain one or more packages. When a repository contains
two or more packages, it is expected that all packages’ versions within the same
repository get updated together. Git will tag them all simultaneously.</p>
</div>
<div class="section" id="continuous-integration">
<h3><a class="toc-backref" href="#id9">Continuous integration</a><a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h3>
<p>Each repository in the workspace contains a few jobs that run under the
following circumstances:</p>
<ul class="simple">
<li>On a push event: the last commit of branch compiles and runs the package
tests with <code class="docutils literal notranslate"><span class="pre">gcc</span></code> and <code class="docutils literal notranslate"><span class="pre">ld</span></code>.</li>
<li>On a pull request event: <code class="docutils literal notranslate"><span class="pre">gcc</span></code> build and tests will be executed. <code class="docutils literal notranslate"><span class="pre">clang</span></code>
build, sanitizers and static analyzer will be triggered using specific labels
in the pull request:<ul>
<li><code class="docutils literal notranslate"><span class="pre">do-clang-test</span></code> executes <code class="docutils literal notranslate"><span class="pre">clang</span></code> build and test, <code class="docutils literal notranslate"><span class="pre">asan</span></code>, <code class="docutils literal notranslate"><span class="pre">ubsan</span></code>
and <code class="docutils literal notranslate"><span class="pre">tsan</span></code> (when enabled) build and test.</li>
<li><code class="docutils literal notranslate"><span class="pre">do-static-analyzer-test</span></code> executes <code class="docutils literal notranslate"><span class="pre">scan-build</span></code> in the project.</li>
</ul>
</li>
<li>Scheduled job: there are two types of scheduled jobs. One that runs every
night and executes a full build and test of the entire workspace with
<code class="docutils literal notranslate"><span class="pre">gcc</span></code>. Another weekly event runs also the sanitizers and static analyzer.
Every night, a tarball with a full build is generated as a way to have
snapshots of the workspace binaries.</li>
</ul>
<p>See <a class="reference internal" href="#compiler-support">Compiler support</a> for more details.</p>
</div>
</div>
<div class="section" id="coding-standards">
<h2><a class="toc-backref" href="#id10">Coding standards</a><a class="headerlink" href="#coding-standards" title="Permalink to this headline">¶</a></h2>
<div class="section" id="languages">
<h3><a class="toc-backref" href="#id11">Languages</a><a class="headerlink" href="#languages" title="Permalink to this headline">¶</a></h3>
<div class="section" id="c-programming">
<h4><a class="toc-backref" href="#id12">C++ programming</a><a class="headerlink" href="#c-programming" title="Permalink to this headline">¶</a></h4>
<p>The workspace uses C++ 17 and each package should compile with <code class="docutils literal notranslate"><span class="pre">gcc</span></code> and
<code class="docutils literal notranslate"><span class="pre">clang</span></code> (see <a class="reference internal" href="#compiler-support">Compiler support</a> for more details).</p>
<p>The workspace follows <a class="reference external" href="https://drake.mit.edu/styleguide/cppguide.html">Drake style guide</a> which is a derivative of
<a class="reference external" href="https://google.github.io/styleguide/cppguide.html">Google style guide</a>.</p>
<p>Exceptions:</p>
<ul class="simple">
<li><a class="reference external" href="https://drake.mit.edu/styleguide/cppguide.html#Line_Length">Line length</a>: is modified to 120 columns to better fit the modern and wider
screens.</li>
</ul>
</div>
<div class="section" id="python-programming">
<h4><a class="toc-backref" href="#id13">Python programming</a><a class="headerlink" href="#python-programming" title="Permalink to this headline">¶</a></h4>
<p>Code is formatted following PEP8.</p>
</div>
<div class="section" id="cmake-programming">
<h4><a class="toc-backref" href="#id14">CMake programming</a><a class="headerlink" href="#cmake-programming" title="Permalink to this headline">¶</a></h4>
<p>CMake is the underlying build system tool and language, it is treated as a first
class citizen like C++ and Python. For that reason, the following general
conventions must be followed on top of <a class="reference external" href="https://index.ros.org/doc/ros2/Contributing/Code-Style-Language-Versions/#cmake">ROS2 CMake conventions</a>.</p>
<div class="section" id="libraries">
<h5><a class="toc-backref" href="#id15">Libraries</a><a class="headerlink" href="#libraries" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>All libraries should be <code class="docutils literal notranslate"><span class="pre">SHARED</span></code> libraries. Consider using
<code class="docutils literal notranslate"><span class="pre">set(BUILD_SHARED_LIBS</span> <span class="pre">true)</span></code> in your top level CMakeLists.txt file.</li>
<li>Libraries should not include in their target name the project name unless they
are the main library in the package. We don’t expect to have as target names
<code class="docutils literal notranslate"><span class="pre">maliput_foo</span></code> for the <code class="docutils literal notranslate"><span class="pre">foo</span></code> functionality.</li>
<li>Use namespaces the following way: <code class="docutils literal notranslate"><span class="pre">project_name\:\:library_name</span></code> as follows:</li>
</ul>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">add_library</span><span class="p">(</span><span class="s">maliput::foo</span> <span class="s">ALIAS</span> <span class="s">foo</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Use <code class="docutils literal notranslate"><span class="pre">_</span></code> instead of <code class="docutils literal notranslate"><span class="pre">-</span></code> in compound names.</li>
<li>Include in the binary name the project name:</li>
</ul>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">set_target_properties</span><span class="p">(</span><span class="s">foo</span>
  <span class="s">PROPERTIES</span>
    <span class="s">OUTPUT_NAME</span> <span class="s">maliput_foo</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>General <code class="docutils literal notranslate"><span class="pre">install()</span></code> commands are expected as follows:</li>
</ul>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">install</span><span class="p">(</span>
  <span class="s">TARGETS</span> <span class="s">foo</span>
  <span class="s">EXPORT</span> <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">-targets</span>
  <span class="s">ARCHIVE</span> <span class="s">DESTINATION</span> <span class="s">lib</span>
  <span class="s">LIBRARY</span> <span class="s">DESTINATION</span> <span class="s">lib</span>
  <span class="s">RUNTIME</span> <span class="s">DESTINATION</span> <span class="s">bin</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Use <code class="docutils literal notranslate"><span class="pre">ament_export_libraries(my_custom_library)</span></code>.</li>
<li>Consider using the generation expressions for target_include_directories
within the project:</li>
</ul>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">foo</span>
  <span class="s">PUBLIC</span>
    <span class="o">$&lt;</span><span class="nv">BUILD_INTERFACE:${PROJECT_SOURCE_DIR}/include</span><span class="o">&gt;</span>
    <span class="o">$&lt;</span><span class="nv">INSTALL_INTERFACE:include</span><span class="o">&gt;</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Header file only libraries should be created as interfaces and header files
must be placed in the include directory at the top level of the package. Make
sure to install those header files later on. The target name is superfluous
because those files will be discoverable by the consuming target if paths are
properly set. However, the decision is to add another layer of security at the
target level.</li>
<li>When using the maliput plugin architecture system, if shared library and executable
are compiled using <cite>ubsan`(undefined behavior sanitizer) the property `ENABLE_EXPORTS</cite>
should be enabled on the executable target in order to instruct the linker to add
all symbols to the dynamic symbol table.
For further information see next <a class="reference external" href="https://stackoverflow.com/questions/57361776/use-ubsan-with-dynamically-loaded-shared-libraries">reference link</a>.</li>
</ul>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">set_target_properties</span><span class="p">(</span><span class="s">foo</span>
  <span class="s">PROPERTIES</span>
    <span class="s">ENABLE_EXPORTS</span> <span class="s">ON</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="executables">
<h5><a class="toc-backref" href="#id16">Executables</a><a class="headerlink" href="#executables" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Use <code class="docutils literal notranslate"><span class="pre">_</span></code> instead of <code class="docutils literal notranslate"><span class="pre">-</span></code> in compound names.</li>
<li><code class="docutils literal notranslate"><span class="pre">install()</span></code> commands are expected as follows:</li>
</ul>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">install</span><span class="p">(</span><span class="s">foo</span>
  <span class="s">EXPORT</span> <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">-targets</span>
  <span class="s">ARCHIVE</span> <span class="s">DESTINATION</span> <span class="s">lib</span>
  <span class="s">LIBRARY</span> <span class="s">DESTINATION</span> <span class="s">lib</span>
  <span class="s">RUNTIME</span> <span class="s">DESTINATION</span> <span class="s">bin</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="resources">
<h5><a class="toc-backref" href="#id17">Resources</a><a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Define a project resources path and install resources following your structure
within <code class="docutils literal notranslate"><span class="pre">share/project_name/resources</span></code> folder in the install space.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="testing">
<h3><a class="toc-backref" href="#id18">Testing</a><a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>100% coverage of the public API of any entity must be unit-tested.</li>
<li>Complex pieces of code that are not exposed should be considered to be
re-engineered in favor of increased coverage.</li>
<li>Integration test between modules can be done when appropriate.</li>
<li>Consider using <code class="docutils literal notranslate"><span class="pre">maliput_integration_tests</span></code> for complex integration tests.</li>
<li><code class="docutils literal notranslate"><span class="pre">gtest</span></code> and <code class="docutils literal notranslate"><span class="pre">gmock</span></code> via <a class="reference external" href="https://github.com/ament/ament_cmake">ament_cmake</a> packages are the default testing
frameworks for C++.</li>
<li><code class="docutils literal notranslate"><span class="pre">python3-pytest</span></code> via <a class="reference external" href="https://github.com/ament/ament_cmake">ament_cmake</a> packages is the default testing
frameworks for Python.</li>
</ul>
</div>
<div class="section" id="linting">
<h3><a class="toc-backref" href="#id19">Linting</a><a class="headerlink" href="#linting" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ament_clang_format</span></code> alone cannot be used because we have a custom format. So
packages hold a tools folder at the root level in which a script called
<code class="docutils literal notranslate"><span class="pre">reformat_code.sh</span></code> calls the previous tool with the custom package.</p>
<p>For Python code, make sure to use <a class="reference external" href="https://github.com/ament/ament_lint/tree/master/ament_cmake_flake8">ament cmake flake8</a>. To do so, you should
follow the <a class="reference external" href="https://github.com/ament/ament_lint/blob/master/ament_cmake_flake8/doc/index.rst">instructions here</a> and use one of the <code class="docutils literal notranslate"><span class="pre">.flake8</span></code> files in your
package root directory to tell the linter which are the tests you want to
perform. In particular, we edit it so it has the following extras:</p>
<div class="highlight-RST notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span># Set the maximum length that any line (with some exceptions) may be.
max-line-length = 100
# Set the maximum allowed McCabe complexity value for a block of code.
max-complexity = 10
# Toggle whether pycodestyle should enforce matching the indentation of the opening bracket’s line.
# incluences E131 and E133
hang-closing = True
# Specify a list of codes to ignore.
ignore =
    E133,
    E226,
# Specify the list of error codes you wish Flake8 to report.
select =
  E,
  W,
  F,
  C
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="supported-oss-and-environments">
<h3><a class="toc-backref" href="#id20">Supported OSs and environments</a><a class="headerlink" href="#supported-oss-and-environments" title="Permalink to this headline">¶</a></h3>
<p>The workspace is only maintained on Ubuntu 18.04 and ROS2 Dashing.</p>
</div>
<div class="section" id="compiler-support">
<h3><a class="toc-backref" href="#id21">Compiler support</a><a class="headerlink" href="#compiler-support" title="Permalink to this headline">¶</a></h3>
<p>The workspace is built with Ubuntu’s default <code class="docutils literal notranslate"><span class="pre">gcc</span></code> (version 7.5) and <code class="docutils literal notranslate"><span class="pre">ld</span></code>
(version 2.30) and <code class="docutils literal notranslate"><span class="pre">clang</span></code> and <code class="docutils literal notranslate"><span class="pre">llvm</span></code> tools (version 8).</p>
<ul class="simple">
<li>Address sanitizer</li>
<li>Undefined behavior sanitizer.</li>
<li>Thread sanitizer.</li>
<li>Static analyzer (scan-build): it runs with <code class="docutils literal notranslate"><span class="pre">clang</span></code>.</li>
</ul>
</div>
</div>
<div class="section" id="versioning">
<h2><a class="toc-backref" href="#id22">Versioning</a><a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">maliput</span></code> packages adhere to <a class="reference external" href="https://semver.org/">semantic versioning</a> and
will follow as much as possible the <a class="reference external" href="https://docs.ros.org/en/foxy/Contributing/Developer-Guide.html#versioning">ROS2 Versioning guidelines</a> .</p>
<div class="section" id="branches-and-tags-for-releases">
<h3><a class="toc-backref" href="#id23">Branches and tags for releases</a><a class="headerlink" href="#branches-and-tags-for-releases" title="Permalink to this headline">¶</a></h3>
<p>The following branches and tags schemes will be used:</p>
<ul class="simple">
<li>Use <code class="docutils literal notranslate"><span class="pre">main</span></code> as the mainline development branch. The tip of
that branch will be the latest development state. It is not safe.
Downstream projects are encouraged to avoid using it unless there is a
business need to do so.</li>
<li>Each repository will have branches with the following pattern:
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">release/1.2.x</span></code>. Each patch release <code class="docutils literal notranslate"><span class="pre">(x)</span></code>
will contain one or more additional bug fix commits relative to the previous
patch release <code class="docutils literal notranslate"><span class="pre">(x</span> <span class="pre">-</span> <span class="pre">1)</span></code>.</li>
</ul>
</div>
</div>
<div class="section" id="releases">
<h2><a class="toc-backref" href="#id24">Releases</a><a class="headerlink" href="#releases" title="Permalink to this headline">¶</a></h2>
<div class="section" id="named-major-releases">
<h3><a class="toc-backref" href="#id25">Named major releases</a><a class="headerlink" href="#named-major-releases" title="Permalink to this headline">¶</a></h3>
<p>Significant releases of Maliput packages will be named. The names will
be chosen based on famous roads and will be alphabetically sorted. Significant
releases will be created on demand.</p>
</div>
<div class="section" id="major-release-output">
<h3><a class="toc-backref" href="#id26">Major release output</a><a class="headerlink" href="#major-release-output" title="Permalink to this headline">¶</a></h3>
<p>Every new major release will provide:</p>
<ul class="simple">
<li>Updated <code class="docutils literal notranslate"><span class="pre">maliput_rolling.repos</span></code> file when appropriate (new major release,
update to latest minor release or patch release).</li>
<li>New <code class="docutils literal notranslate"><span class="pre">maliput_&lt;name&gt;.repos</span></code> file.</li>
<li>Updated tarball in S3 bucket with the following name pattern: <code class="docutils literal notranslate"><span class="pre">maliput_ws_&lt;name&gt;_YYYYMMDD_bionic.tar.gz</span></code>
where <code class="docutils literal notranslate"><span class="pre">name</span></code> is the release name and <code class="docutils literal notranslate"><span class="pre">YYYYMMDD</span></code> is the release date (see
<a class="reference internal" href="#create-a-named-release-tarball"><span class="std std-ref">Create a named release tarball</span></a> ).</li>
</ul>
</div>
<div class="section" id="how-to-release">
<h3><a class="toc-backref" href="#id27">How to release?</a><a class="headerlink" href="#how-to-release" title="Permalink to this headline">¶</a></h3>
<p>There are different steps to follow based on the type of release you want to
create.</p>
<div class="section" id="make-a-new-major-maliput-workspace-release">
<h4><a class="toc-backref" href="#id28">Make a new major <code class="docutils literal notranslate"><span class="pre">maliput</span></code> workspace release</a><a class="headerlink" href="#make-a-new-major-maliput-workspace-release" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Choose a name that is next in the alphabet relative to the previous major
release.</li>
<li>Prepare the workspace by pinning all dependencies and downstream packages to
their target branches or tags.</li>
<li>Build and test the workspace with all packages pointing to their pinned
versions.</li>
<li>Update <code class="docutils literal notranslate"><span class="pre">maliput_rolling.repos</span></code> file in <a class="reference external" href="https://github.com/ToyotaResearchInstitute/repos_index">repos_index</a>
under the appropriate ROS2 distro folder.</li>
<li>Create a new <code class="docutils literal notranslate"><span class="pre">maliput_&lt;name&gt;.repos</span></code> file in <a class="reference external" href="https://github.com/ToyotaResearchInstitute/repos_index">repos_index</a>
under the appropriate ROS2 distro folder.</li>
<li>Create a binary tarball of the workspace (see <a class="reference internal" href="#create-a-named-release-tarball"><span class="std std-ref">Create a named release tarball</span></a>).</li>
<li>Upload the binary tarball to Amazon S3 bucket.</li>
</ul>
</div>
<div class="section" id="create-a-new-package-major-release">
<h4><a class="toc-backref" href="#id29">Create a new package major release</a><a class="headerlink" href="#create-a-new-package-major-release" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Prepare the workspace by pinning all dependencies and downstream packages to
their target branches or tags.</li>
<li>Prepare the release branch:<ul>
<li>Update the <code class="docutils literal notranslate"><span class="pre">CHANGELOG.rst</span></code> and <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> files via a PR targeting
<code class="docutils literal notranslate"><span class="pre">main</span></code>.</li>
<li>From <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, create a new branch called
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>. <code class="docutils literal notranslate"><span class="pre">x</span></code> is not a placeholder, it is the literal
<strong>x</strong> because this branch will contain all the potential future patch
releases in the series of <code class="docutils literal notranslate"><span class="pre">major.minor.0</span></code>, <code class="docutils literal notranslate"><span class="pre">major.minor.1</span></code> and so on (e.g.
<cite>1.3.0</cite>, <cite>1.3.1</cite>, <cite>1.3.2</cite>, etc.). A tag will be used to name the specific
commit in the branch.</li>
<li>Run <strong>all</strong> tests. If you encounter any problem, send PRs to fix them
targeting <code class="docutils literal notranslate"><span class="pre">main</span></code> branch. Merge those commits into
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
</ul>
</li>
<li>Push the branch.</li>
<li>Make a tag with the appropriate version number: <code class="docutils literal notranslate"><span class="pre">release/major.minor.0</span></code>.</li>
<li>Push the tag.</li>
<li>Create a PR to <a class="reference external" href="https://github.com/ToyotaResearchInstitute/repos_index">repos_index</a>
and update <code class="docutils literal notranslate"><span class="pre">maliput_rolling.repos</span></code> to indicate the branch name
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code> as the latest package version.</li>
</ul>
</div>
<div class="section" id="create-a-new-package-minor-release">
<h4><a class="toc-backref" href="#id30">Create a new package minor release</a><a class="headerlink" href="#create-a-new-package-minor-release" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Prepare the workspace by pinning all dependencies and downstream packages to
their target branches or tags.</li>
<li>Prepare the release branch:<ul>
<li>From the tip of <code class="docutils literal notranslate"><span class="pre">release/major.[minor</span> <span class="pre">-</span> <span class="pre">1].x</span></code>, create a new branch called
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
<li>Push the branch <code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
<li>Cherry-pick commits as needed from <code class="docutils literal notranslate"><span class="pre">main</span></code> and include them into
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code> via PRs. Alternatively, create feature branches
whose PRs target <code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
<li>Update the <code class="docutils literal notranslate"><span class="pre">CHANGELOG.rst</span></code> and <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> via a PR targeting
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
<li>Run <strong>all</strong> tests. If you encounter any problem, send PRs to fix them
targeting <code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code> branch.</li>
</ul>
</li>
<li>Make a tag with the appropriate version number: <code class="docutils literal notranslate"><span class="pre">release/major.minor.0</span></code>.</li>
<li>Push the tag.</li>
<li>When the <code class="docutils literal notranslate"><span class="pre">major</span></code> and <code class="docutils literal notranslate"><span class="pre">minor</span></code> version numbers are the greatest: create a PR
to <a class="reference external" href="https://github.com/ToyotaResearchInstitute/repos_index">repos_index</a>
and update <code class="docutils literal notranslate"><span class="pre">maliput_rolling.repos</span></code> to indicate the branch name
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code> as the latest package version.</li>
<li>Consider updating the affected named  <code class="docutils literal notranslate"><span class="pre">maliput</span></code> workspace releases.</li>
</ul>
</div>
<div class="section" id="create-a-new-package-patch-release">
<h4><a class="toc-backref" href="#id31">Create a new package patch release</a><a class="headerlink" href="#create-a-new-package-patch-release" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Prepare the workspace by pinning all dependencies and downstream packages to
their target branches or tags.</li>
<li>Prepare the release branch:<ul>
<li>Cherry-pick commits as needed from <code class="docutils literal notranslate"><span class="pre">main</span></code> and include them into
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code> via PRs. Alternatively, create feature branches
whose PRs target <code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
<li>Update the <code class="docutils literal notranslate"><span class="pre">CHANGELOG.rst</span></code> and <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> via a PR targeting
<code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code>.</li>
<li>Run <strong>all</strong> tests. If you encounter any problem, send PRs to fix them
targeting <code class="docutils literal notranslate"><span class="pre">release/major.minor.x</span></code> branch.</li>
</ul>
</li>
<li>Make a tag with the appropriate version number: <code class="docutils literal notranslate"><span class="pre">release/major.minor.patch</span></code>.</li>
<li>Push the tag.</li>
<li>Consider updating the affected named <code class="docutils literal notranslate"><span class="pre">maliput</span></code> workspace release.</li>
</ul>
</div>
<div class="section" id="create-a-named-release-tarball">
<span id="id5"></span><h4><a class="toc-backref" href="#id32">Create a named release tarball</a><a class="headerlink" href="#create-a-named-release-tarball" title="Permalink to this headline">¶</a></h4>
<p>To generate the tarball:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /path/to/maliput_ws
<span class="nb">export</span> <span class="nv">BUNDLE_NAME</span><span class="o">=</span>maliput_ws_name
mv install <span class="si">${</span><span class="nv">BUNDLE_NAME</span><span class="si">}</span><span class="p">;</span>
<span class="nv">CURRENT_BUNDLE_TARBALL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BUNDLE_NAME</span><span class="si">}</span><span class="s2">_</span><span class="k">$(</span>date +%Y%m%d<span class="k">)</span><span class="s2">_bionic.tar.gz&quot;</span>
tar -czvf <span class="si">${</span><span class="nv">CURRENT_BUNDLE_TARBALL_NAME</span><span class="si">}</span> <span class="si">${</span><span class="nv">BUNDLE_NAME</span><span class="si">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation_quickstart.html">Installation and Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Documentation</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation_quickstart.html"
                        title="previous chapter">Installation and Quickstart</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="contributing.html"
                        title="next chapter">Contributing</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="contributing.html" title="Contributing"
             >next</a> |</li>
        <li class="right" >
          <a href="installation_quickstart.html" title="Installation and Quickstart"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Maliput Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020 Toyota Research Institute.
    </div>
  </body>
</html>